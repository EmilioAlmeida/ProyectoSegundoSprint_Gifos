function timerActive(){++seconds<10&&(seconds="0"+seconds),seconds>59&&(seconds="00",++minutes<10&&(minutes="0"+minutes)),minutes>59&&(minutes="00",++hours<10&&(hours="0"+hours)),$timer.innerHTML=`${hours}:${minutes}:${seconds}`}$buttonGrabar.style.display="none",$buttonFinalizar.style.display="none",$buttonSubirGif.style.display="none",$overlay.style.display="none";let recorder,myGifos,timer,form=new FormData,arrMyGifos=[],hours="00",minutes="00",seconds="00";const getStreamAndRecord=async()=>{$crearGifTitle.innerHTML="¿Nos das acceso <br> a tu cámara?",$crearGifText.innerHTML="El acceso a tu camara será válido sólo <br> por el tiempo en el que estés creando el GIFO.",$buttonComenzar.style.visibility="hidden",$step1.classList.add("step-active"),await navigator.mediaDevices.getUserMedia({audio:!1,video:{height:{max:480}}}).then(e=>{$crearGifTitle.classList.add("hidden"),$crearGifText.classList.add("hidden"),$step1.classList.remove("step-active"),$step2.classList.add("step-active"),$buttonComenzar.style.display="none",$buttonGrabar.style.display="block",$video.classList.remove("hidden"),$video.srcObject=e,$video.play(),recorder=RecordRTC(e,{type:"gif",frameRate:1,quality:10,width:360,hidden:240,onGifRecordingStarted:function(){console.log("started")}})}).catch(e=>console.log(e))};$buttonComenzar.addEventListener("click",getStreamAndRecord);const createGifo=()=>{console.log("está grabando"),$buttonGrabar.style.display="none",$buttonFinalizar.style.display="block",$timer.classList.remove("hidden"),$repeatBtn.classList.add("hidden"),recorder.startRecording(),timer=setInterval(timerActive,1e3)};$buttonGrabar.addEventListener("click",createGifo);const stopCreatingGif=()=>{$video.classList.add("hidden"),$recordedGifo.classList.remove("hidden"),recorder.stopRecording(()=>{let e=recorder.getBlob();$recordedGifo.src=URL.createObjectURL(e),form.append("file",recorder.getBlob(),"myGif.gif"),console.log(form.get("file"))}),$buttonFinalizar.style.display="none",$buttonSubirGif.style.display="block",$timer.classList.add("hidden"),$repeatBtn.classList.remove("hidden"),clearInterval(timer),hours="00",minutes="00",seconds="00",$timer.innerText=`${hours}:${minutes}:${seconds}`};$buttonFinalizar.addEventListener("click",stopCreatingGif);const uploeadCreatedGif=async()=>{$overlay.style.display="flex",$step2.classList.remove("step-active"),$step3.classList.add("step-active"),$repeatBtn.classList.add("hidden"),$buttonSubirGif.style.visibility="hidden",await fetch(`${uploadGifEndpoint}?api_key=${apiKey}`,{method:"POST",body:form}).then(e=>e.json()).then(e=>{let t=e.data.id;console.log(e.data.id),$overlayStatusIcon.src="assets/check.svg",$overlayStatusText.innerHTML="GIFO subido con éxito";let i=document.createElement("div");i.classList.add("overlay_buttons"),i.innerHTML=`<div class="btns downloadOverlay" onclick="downloadCreatedGif('${t}')"></div> \n\t\t\t<div class="btns linkOverlay" onclick="displayMisGifosSection(event)"></div>`,$overlay.appendChild(i),arrMyGifos.push(t),console.log(arrMyGifos),myGifos=localStorage.setItem("MyGifs",JSON.stringify(arrMyGifos))}).catch(e=>{console.error(e)})};$buttonSubirGif.addEventListener("click",uploeadCreatedGif);const repeatRecordingGif=e=>{e.preventDefault(),recorder.clearRecordedData(),$step2.classList.add("step-active"),$repeatBtn.classList.add("hidden"),$buttonGrabar.style.display="block",$buttonSubirGif.style.display="none",$video.classList.remove("hidden"),$recordedGifo.classList.add("hidden"),navigator.mediaDevices.getUserMedia({audio:!1,video:{height:{max:480}}}).then(e=>{$video.srcObject=e,$video.play(),recorder=RecordRTC(e,{type:"gif",frameRate:1,quality:10,width:360,hidden:240,onGifRecordingStarted:function(){console.log("started")}})}).catch(e=>console.log(e))};$repeatBtn.addEventListener("click",repeatRecordingGif);const downloadCreatedGif=async e=>{let t=await fetch(`https://media.giphy.com/media/${e}/giphy.gif`).then(e=>e.blob());invokeSaveAsDialog(t,"My-Gif.gif")};